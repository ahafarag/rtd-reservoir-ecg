# RTD-Based Reservoir Computing for ECG Analysis

> ⚠️ **Disclaimer:** This repository contains documentation for a research project that includes patent-pending technology. The code and concepts are shared for academic and evaluation purposes only and are not authorized for redistribution or commercial reuse without explicit licensing.

## 🧠 Project Overview

This project presents a novel framework for **real-time ECG signal analysis and prediction** using a hardware-inspired **Reservoir Computing (RC)** model based on the physics of Resonant Tunneling Diodes (RTDs). The system is designed to achieve high accuracy in critical diagnostic tasks, such as arrhythmia detection, while maintaining the potential for ultra-low-power implementation suitable for wearable health devices.

This repository serves as the software simulation and validation component of a master's thesis, combining:
- Neuromorphic computing principles
- Biomedical signal processing
- A Python/ML stack (Scikit-learn, Pandas, Matplotlib)
- An interactive Streamlit interface for simulation and analysis

> **Keywords:** Reservoir Computing, Resonant Tunneling Diode (RTD), ECG Prediction, Arrhythmia Detection, Time-Series Analysis, Neuromorphic Hardware, Biomedical Signal Processing.

---

## 📈 Motivation

Real-time analysis of electrocardiogram (ECG) signals on power-constrained wearable devices is a major challenge. While traditional machine learning models can be effective, they often require significant computational resources, making them unsuitable for continuous, on-device monitoring.

Reservoir Computing (RC) provides a compelling alternative by offering:
- **Rapid Training:** Only the final "readout" layer is trained, dramatically reducing computational overhead.
- **High Performance:** Excels at modeling complex and chaotic time-series data like ECG signals.
- **Hardware Compatibility:** The RC paradigm is exceptionally well-suited for implementation in analog hardware, with RTDs offering a promising path to micro-watt power consumption.

This work proposes a model using multiple parallel reservoirs, emulating the nonlinear dynamics of RTDs to efficiently capture the rich temporal features of the human heartbeat.

---

## ✅ Datasets Used for Validation

To ensure the robustness and clinical relevance of the model, it has been rigorously tested and validated on two industry-standard, publicly available ECG datasets:

1.  **PTB-XL ECG Dataset:** A large-scale dataset containing 21,837 clinical 12-lead ECG records from 18,885 patients. It is annotated with a comprehensive set of diagnostic labels, making it ideal for training and validating arrhythmia classification and other predictive tasks.
2.  **MIT-BIH Arrhythmia Database:** A foundational dataset in the field of arrhythmia analysis, consisting of 48 half-hour excerpts of two-channel ambulatory ECG recordings. It includes a variety of common and life-threatening arrhythmias and is the gold standard for benchmarking heartbeat classification algorithms.

---

## 🧪 Methodology

The core simulation pipeline follows these steps:
```
Raw ECG Signal ➝ Preprocessing (Normalization) ➝ [RTD Reservoir 1]
                                                ➝ [RTD Reservoir 2] ➝ Concatenated States ➝ Trainable Readout ➝ Prediction
                                                ➝ [RTD Reservoir N]
```
Each simulated RTD reservoir applies a unique nonlinear transformation to the input signal, creating a rich set of features over time. The states from all reservoirs are then concatenated and fed into a simple, trainable readout layer (e.g., a Ridge Regression or shallow MLP) to produce the final prediction.

---

## 🧮 Mathematical Formulation

The state update equation for a single reservoir unit is defined as:

```math
\mathbf{x}_t = (1 - \alpha) \mathbf{x}_{t-1} + \alpha \cdot \tanh(\mathbf{W}_{in} u_{t-d})
```

Where:
- $\mathbf{x}_t$ is the reservoir state at time $t$.
- $\alpha$ is the leaking rate.
- $u_t$ is the input signal at time $t$.
- $d$ is the input delay.
- $\mathbf{W}_{in}$ is the input weight matrix.

The final prediction $\hat{y}_t$ is generated by the readout layer:

```math
\hat{y}_t = \mathbf{W}_{out} \cdot [\mathbf{x}_{t}^{(1)}, \mathbf{x}_{t}^{(2)}, ..., \mathbf{x}_{t}^{(N)}]
```

---

## 📊 Results

The model demonstrates state-of-the-art performance in both ECG forecasting and arrhythmia classification tasks. The following results were achieved on the PTB-XL dataset. Detailed comparative results for both datasets are available in the full thesis document.

| Metric | Value |
| :--- | :--- |
| **Classification Accuracy** | 99.46% |
| **Forecasting R² Score** | 0.9948 |
| **Forecasting MAE** | 0.0453 |
| **Forecasting RMSE** | 0.0724 |

---

## 🖥️ GUI Interface (Streamlit)

An interactive GUI allows for easy experimentation and visualization:
- Load ECG data from CSV or use built-in samples from the PTB-XL and MIT-BIH datasets.
- Adjust reservoir parameters (size, delay, leaking rate).
- Select the readout model (MLP or Ridge Regression).
- Visualize the predicted waveform against the true signal.
- Plot prediction errors and highlight detected anomalies.
- Export results to PDF, video, or CSV.

---

## 📂 Project Structure
```
├── main_app.py              # Streamlit frontend
├── reservoir.py             # Core reservoir class
├── ecg_loader.py            # Data loading and preprocessing
├── utils.py                 # Plotting, video, and export utilities
├── requirements.txt         # Project dependencies
├── README.md                # This document
└── /docs
    ├── fig_prediction_example.png
└── /images
    ├── 001.png
    └── 002.png
```

---

## 🚀 Future Work and Extensions

While the simulation results are highly promising, future work will focus on:
- **Hardware Prototyping:** Fabricating a physical prototype with actual RTD chips to validate the simulated power consumption and performance benefits.
- **Robustness to Noise:** Systematically evaluating the model's performance against various types of noise commonly found in wearable sensor data.
- **Expanded Clinical Validation:** Collaborating with medical professionals to test the model on a wider range of arrhythmias and patient populations.
- **Theoretical Analysis:** Further developing the theoretical understanding of how RTD dynamics map to the computational properties of the reservoir.

---

## 📘 References

1.  Jaeger, H. (2001). *The "echo state" approach to analysing and training recurrent neural networks.* GMD Report 148.
2.  Appeltant, L., et al. (2011). *Information processing using a single dynamical node as complex system.* Nature Communications.
3.  Goldberger, A. L., et al. (2000). *PhysioBank, PhysioToolkit, and PhysioNet.* Circulation.
4.  Wagner, P., et al. (2020). *PTB-XL, a large publicly available electrocardiography dataset.* Scientific Data.

---

## 🧑‍🎓 Thesis Suitability

This project is highly suitable for:
- MSc/PhD in Artificial Intelligence, Neuromorphic Engineering, or Biomedical Engineering.
- Students aiming to bridge the gap between hardware-inspired computing and applied machine learning.
- Research into interpretable, low-power AI for healthcare.

---

## 📌 How to Run

1.  Install the required dependencies:
    ```bash
    pip install -r requirements.txt
    ```
2.  Launch the Streamlit application:
    ```bash
    streamlit run main_app.py
    ```

---

## ⚖️ License

This program incorporates patent-pending technology. Any use of the described single-RTD or multi-RTD reservoir architecture for commercial purposes requires explicit licensing. Please contact the author for inquiries.
